import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useState, useEffect } from "react";
export const USDTPaymentComponent = ({ plan, finalPrice, onProcess, isProcessing, disabled = false, }) => {
    const [usdtPrice, setUsdtPrice] = useState(0);
    const [usdtAmount, setUsdtAmount] = useState(0);
    const [showInstructions, setShowInstructions] = useState(false);
    const [loadingPrice, setLoadingPrice] = useState(true);
    const [selectedNetwork, setSelectedNetwork] = useState("ethereum");
    // Carregar cotação do USDT
    useEffect(() => {
        const fetchUSDTPrice = async () => {
            try {
                setLoadingPrice(true);
                const response = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=tether&vs_currencies=brl");
                const data = await response.json();
                const price = data.tether.brl;
                setUsdtPrice(price);
                setUsdtAmount(finalPrice / price);
            }
            catch (error) {
                console.error("Erro ao buscar cotação USDT:", error);
                // Fallback com cotação aproximada (1 USDT ≈ R$ 5,50)
                setUsdtPrice(5.5);
                setUsdtAmount(finalPrice / 5.5);
            }
            finally {
                setLoadingPrice(false);
            }
        };
        fetchUSDTPrice();
        // Atualizar cotação a cada 30 segundos
        const interval = setInterval(fetchUSDTPrice, 30000);
        return () => clearInterval(interval);
    }, [finalPrice]);
    const networkInfo = {
        ethereum: {
            name: "Ethereum",
            symbol: "ETH",
            fee: "$5-15",
            time: "2-10 min",
            color: "blue",
        },
        polygon: {
            name: "Polygon",
            symbol: "MATIC",
            fee: "$0.01-0.1",
            time: "1-3 min",
            color: "purple",
        },
    };
    return (_jsxs("div", { className: "usdt-payment-component", children: [_jsxs("div", { className: "mb-6", children: [_jsxs("div", { className: "flex items-center space-x-3 mb-4", children: [_jsx("div", { className: "text-4xl", children: "\uD83D\uDCB0" }), _jsxs("div", { children: [_jsx("h3", { className: "text-xl font-bold text-gray-800", children: "Pagamento via USDT" }), _jsx("p", { className: "text-sm text-gray-600", children: "Stablecoin \u2022 Valor est\u00E1vel \u2022 3% de desconto" })] })] }), _jsxs("div", { className: "bg-green-50 border border-green-200 rounded-lg p-4 mb-4", children: [_jsxs("div", { className: "flex items-center space-x-2 mb-2", children: [_jsx("span", { className: "text-green-500", children: "\uD83D\uDC8E" }), _jsx("span", { className: "text-sm font-medium text-green-800", children: "Desconto de 3% + Valor est\u00E1vel" })] }), _jsx("p", { className: "text-sm text-green-700", children: "USDT \u00E9 uma stablecoin pareada ao d\u00F3lar americano, oferecendo estabilidade de pre\u00E7o." })] }), _jsxs("div", { className: "space-y-3", children: [_jsxs("div", { className: "flex justify-between items-center py-2 border-b border-gray-100", children: [_jsx("span", { className: "text-gray-600", children: "Plano:" }), _jsx("span", { className: "font-medium", children: plan.name })] }), _jsxs("div", { className: "flex justify-between items-center py-2 border-b border-gray-100", children: [_jsx("span", { className: "text-gray-600", children: "Valor original:" }), _jsxs("span", { className: "text-gray-500 line-through", children: ["R$ ", plan.price.toFixed(2)] })] }), _jsxs("div", { className: "flex justify-between items-center py-2 border-b border-gray-100", children: [_jsx("span", { className: "text-gray-600", children: "Valor com desconto:" }), _jsxs("span", { className: "text-xl font-bold text-green-600", children: ["R$ ", finalPrice.toFixed(2)] })] }), _jsxs("div", { className: "flex justify-between items-center py-2", children: [_jsx("span", { className: "text-gray-600", children: "Equivalente em USDT:" }), _jsx("div", { className: "text-right", children: loadingPrice ? (_jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("div", { className: "w-4 h-4 border-2 border-green-500 border-t-transparent rounded-full animate-spin" }), _jsx("span", { className: "text-sm text-gray-500", children: "Calculando..." })] })) : (_jsxs(_Fragment, { children: [_jsxs("div", { className: "font-bold text-green-600", children: ["$", usdtAmount.toFixed(2), " USDT"] }), _jsxs("div", { className: "text-xs text-gray-500", children: ["1 USDT = R$ ", usdtPrice.toFixed(2)] })] })) })] })] })] }), _jsxs("div", { className: "mb-6", children: [_jsx("h4", { className: "text-sm font-medium text-gray-700 mb-3", children: "Escolha a rede blockchain:" }), _jsx("div", { className: "grid grid-cols-2 gap-3", children: Object.entries(networkInfo).map(([key, info]) => (_jsxs("button", { onClick: () => setSelectedNetwork(key), className: `
                p-3 rounded-lg border-2 transition-all duration-200 text-left
                ${selectedNetwork === key
                                ? `border-${info.color}-500 bg-${info.color}-50`
                                : "border-gray-200 hover:border-gray-300"}
              `, children: [_jsx("div", { className: "font-medium text-gray-800", children: info.name }), _jsxs("div", { className: "text-xs text-gray-600 mt-1", children: [_jsxs("div", { children: ["Taxa: ", info.fee] }), _jsxs("div", { children: ["Tempo: ", info.time] })] })] }, key))) }), _jsx("p", { className: "text-xs text-gray-500 mt-2", children: "Recomendamos Polygon para taxas menores e confirma\u00E7\u00E3o mais r\u00E1pida." })] }), _jsxs("div", { className: "mb-6 p-4 bg-gray-50 rounded-lg", children: [_jsx("h4", { className: "text-sm font-medium text-gray-700 mb-2", children: "Por que escolher USDT?" }), _jsxs("div", { className: "space-y-2 text-sm text-gray-600", children: [_jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("span", { className: "text-green-500", children: "\uD83D\uDC8E" }), _jsx("span", { children: "Valor est\u00E1vel pareado ao d\u00F3lar americano" })] }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("span", { className: "text-green-500", children: "\uD83D\uDE80" }), _jsx("span", { children: "Confirma\u00E7\u00E3o r\u00E1pida na blockchain" })] }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("span", { className: "text-green-500", children: "\uD83D\uDCB0" }), _jsx("span", { children: "3% de desconto exclusivo" })] }), _jsxs("div", { className: "flex items-center space-x-2", children: [_jsx("span", { className: "text-green-500", children: "\uD83C\uDF0D" }), _jsx("span", { children: "Aceito globalmente" })] })] })] }), _jsxs("div", { className: "mb-6", children: [_jsxs("button", { onClick: () => setShowInstructions(!showInstructions), className: "flex items-center justify-between w-full p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors", children: [_jsx("span", { className: "text-sm font-medium text-gray-700", children: "Como funciona o pagamento USDT?" }), _jsx("span", { className: `transform transition-transform ${showInstructions ? "rotate-180" : ""}`, children: "\u25BC" })] }), showInstructions && (_jsx("div", { className: "mt-3 p-4 bg-green-50 border border-green-200 rounded-lg", children: _jsxs("ol", { className: "text-sm text-green-800 space-y-2", children: [_jsxs("li", { className: "flex items-start space-x-2", children: [_jsx("span", { className: "flex-shrink-0 w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold", children: "1" }), _jsx("span", { children: "Clique em \"Gerar Endere\u00E7o USDT\" abaixo" })] }), _jsxs("li", { className: "flex items-start space-x-2", children: [_jsx("span", { className: "flex-shrink-0 w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold", children: "2" }), _jsx("span", { children: "Copie o endere\u00E7o ou escaneie o QR Code" })] }), _jsxs("li", { className: "flex items-start space-x-2", children: [_jsx("span", { className: "flex-shrink-0 w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold", children: "3" }), _jsx("span", { children: "Envie exatamente o valor em USDT da sua carteira" })] }), _jsxs("li", { className: "flex items-start space-x-2", children: [_jsx("span", { className: "flex-shrink-0 w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold", children: "4" }), _jsx("span", { children: "Aguarde confirma\u00E7\u00F5es na blockchain (1-10 min)" })] }), _jsxs("li", { className: "flex items-start space-x-2", children: [_jsx("span", { className: "flex-shrink-0 w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold", children: "5" }), _jsx("span", { children: "Seu acesso ser\u00E1 liberado automaticamente" })] })] }) }))] }), _jsx("button", { onClick: onProcess, disabled: disabled || isProcessing || loadingPrice, className: `
          w-full py-4 px-6 rounded-lg font-semibold text-white transition-all duration-200
          ${disabled || isProcessing || loadingPrice
                    ? "bg-gray-400 cursor-not-allowed"
                    : "bg-green-600 hover:bg-green-700 active:bg-green-800 shadow-lg hover:shadow-xl"}
        `, children: isProcessing ? (_jsxs("div", { className: "flex items-center justify-center space-x-2", children: [_jsx("div", { className: "w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin" }), _jsx("span", { children: "Gerando Endere\u00E7o USDT..." })] })) : loadingPrice ? (_jsxs("div", { className: "flex items-center justify-center space-x-2", children: [_jsx("div", { className: "w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin" }), _jsx("span", { children: "Carregando Cota\u00E7\u00E3o..." })] })) : (_jsxs("div", { className: "flex items-center justify-center space-x-2", children: [_jsx("span", { children: "\uD83D\uDCB0" }), _jsxs("span", { children: ["Gerar Endere\u00E7o USDT (", networkInfo[selectedNetwork].name, ")"] })] })) }), _jsxs("div", { className: "mt-4 space-y-2", children: [_jsxs("div", { className: "flex items-center justify-center space-x-4 text-xs text-gray-500", children: [_jsxs("div", { className: "flex items-center space-x-1", children: [_jsx("span", { children: "\uD83D\uDC8E" }), _jsx("span", { children: "Stablecoin" })] }), _jsxs("div", { className: "flex items-center space-x-1", children: [_jsx("span", { children: "\uD83D\uDE80" }), _jsx("span", { children: "R\u00E1pido" })] }), _jsxs("div", { className: "flex items-center space-x-1", children: [_jsx("span", { children: "\uD83D\uDCB0" }), _jsx("span", { children: "3% OFF" })] })] }), _jsxs("p", { className: "text-xs text-gray-500 text-center", children: ["Rede ", networkInfo[selectedNetwork].name, " \u2022 Taxa:", " ", networkInfo[selectedNetwork].fee, " \u2022 Tempo:", " ", networkInfo[selectedNetwork].time] })] }), _jsxs("div", { className: "mt-6 p-4 bg-gray-50 rounded-lg", children: [_jsx("h4", { className: "text-sm font-medium text-gray-700 mb-2", children: "Carteiras USDT compat\u00EDveis:" }), _jsxs("div", { className: "grid grid-cols-4 gap-2 text-xs text-gray-600", children: [_jsx("div", { className: "text-center", children: "MetaMask" }), _jsx("div", { className: "text-center", children: "Trust Wallet" }), _jsx("div", { className: "text-center", children: "Coinbase" }), _jsx("div", { className: "text-center", children: "Binance" }), _jsx("div", { className: "text-center", children: "Exodus" }), _jsx("div", { className: "text-center", children: "Ledger" }), _jsx("div", { className: "text-center", children: "Trezor" }), _jsx("div", { className: "text-center", children: "+ outras" })] })] }), _jsx("div", { className: "mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg", children: _jsxs("div", { className: "flex items-start space-x-2", children: [_jsx("span", { className: "text-yellow-500 mt-0.5", children: "\u26A0\uFE0F" }), _jsxs("div", { className: "text-xs text-yellow-800", children: [_jsx("p", { className: "font-medium mb-1", children: "Importante:" }), _jsxs("p", { children: ["Certifique-se de enviar USDT na rede", " ", networkInfo[selectedNetwork].name, " correta. Envios em redes diferentes podem resultar em perda dos fundos."] })] })] }) })] }));
};
